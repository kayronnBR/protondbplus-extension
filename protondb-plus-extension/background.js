// IMPORTANTE: Mantenha as CHAVES (lado esquerdo) sempre em MINÚSCULAS
const redirects = {
"tibia": "2025/11/tibia",
"y8 games": "https://protondbplus.blogspot.com/2026/02/y8-games.html",
"y8games": "https://protondbplus.blogspot.com/2026/02/y8-games.html",
"the queen of heart '99": "https://protondbplus.blogspot.com/2026/02/the-queen-of-heart-99.html",
"the queen of heart 99": "https://protondbplus.blogspot.com/2026/02/the-queen-of-heart-99.html",
"the queen of heart": "https://protondbplus.blogspot.com/2026/02/the-queen-of-heart-99.html",
"swat: elite force": "https://protondbplus.blogspot.com/2025/12/swat-elite-force.html",
"swat elite force": "https://protondbplus.blogspot.com/2025/12/swat-elite-force.html",
"malody": "https://protondbplus.blogspot.com/2025/12/malody.html",
"american mcgee's alice": "https://protondbplus.blogspot.com/2025/12/american-mcgees-alice-2000.html",
"American McGees Alice": "https://protondbplus.blogspot.com/2025/12/american-mcgees-alice-2000.html",
"you are empty": "https://protondbplus.blogspot.com/2025/12/you-are-empty-2006.html",
"pod gold": "https://protondbplus.blogspot.com/2025/11/pod-gold-1997.html",
"pod: gold": "https://protondbplus.blogspot.com/2025/11/pod-gold-1997.html",
"the simpsons hit run": "https://protondbplus.blogspot.com/2025/11/the-simpsons-hit-run-2003.html",
"the simpsons hit and run": "https://protondbplus.blogspot.com/2025/11/the-simpsons-hit-run-2003.html",
"the simpsons hit & run": "https://protondbplus.blogspot.com/2025/11/the-simpsons-hit-run-2003.html",
"clone hero": "https://protondbplus.blogspot.com/2025/11/clone-hero.html",
"better gh3": "https://protondbplus.blogspot.com/2025/11/better-gh-3.html",
"better gh 3": "https://protondbplus.blogspot.com/2025/11/better-gh-3.html",
"guitar hero 3": "https://protondbplus.blogspot.com/2025/11/better-gh-3.html",
"atomic bomberman": "https://protondbplus.blogspot.com/2025/11/atomic-bomberman-1997.html",
"spider-man 2: the game": "https://protondbplus.blogspot.com/2025/11/spider-man-2-game-2004.html",
"spider man 2 the game": "https://protondbplus.blogspot.com/2025/11/spider-man-2-game-2004.html",
"stunt gp": "https://protondbplus.blogspot.com/2025/11/stunt-gp.html",
"gp 500": "https://protondbplus.blogspot.com/2025/11/gp-500.html",
"halo zero": "https://protondbplus.blogspot.com/2025/11/halo-zero.html",
"the house of dead iii": "https://protondbplus.blogspot.com/2025/11/the-house-of-dead-iii.html",
"the house of dead lll": "https://protondbplus.blogspot.com/2025/11/the-house-of-dead-iii.html",
"the house of dead 3": "https://protondbplus.blogspot.com/2025/11/the-house-of-dead-iii.html",
"sonic riders x": "https://protondbplus.blogspot.com/2025/11/sonic-riders-x.html",
"the house of dead ii": "https://protondbplus.blogspot.com/2025/11/the-house-of-dead-2.html",
"the house of dead ll": "https://protondbplus.blogspot.com/2025/11/the-house-of-dead-2.html",
"the house of dead 2": "https://protondbplus.blogspot.com/2025/11/the-house-of-dead-2.html",
"adrenalin: extreme show": "https://protondbplus.blogspot.com/2025/11/adrenalin-extreme-show.html",
"adrenalin extreme show": "https://protondbplus.blogspot.com/2025/11/adrenalin-extreme-show.html",
"the house of dead": "https://protondbplus.blogspot.com/2025/11/the-house-of-dead.html",
"power rangers: super legends - 15th anniversary": "https://protondbplus.blogspot.com/2025/11/power-rangers-super-legends-15th.html",
"power rangers super legends 15th anniversary": "https://protondbplus.blogspot.com/2025/11/power-rangers-super-legends-15th.html",
"power rangers super legends 15th": "https://protondbplus.blogspot.com/2025/11/power-rangers-super-legends-15th.html",
"power rangers super legends": "https://protondbplus.blogspot.com/2025/11/power-rangers-super-legends-15th.html",
"sonic mega collection plus": "https://protondbplus.blogspot.com/2025/11/sonic-mega-collection-plus.html",
"sonic knuckles collection": "https://protondbplus.blogspot.com/2025/11/sonic-knuckles-collection.html",
"sonic riders": "https://protondbplus.blogspot.com/2025/11/sonic-riders.html",
"sonic r": "https://protondbplus.blogspot.com/2025/11/sonic-heroes.html",
"sonic 3d blast": "https://protondbplus.blogspot.com/2025/11/sonic-3d-blast.html",
"swat 4 gold edition": "https://protondbplus.blogspot.com/2025/11/swat-4-gold-edition.html",
"swat 4: gold edition": "https://protondbplus.blogspot.com/2025/11/swat-4-gold-edition.html",
"tony hawk's pro skater 2": "https://protondbplus.blogspot.com/2025/11/tony-hawks-pro-skater-2-2000.html",
"tony hawks pro skater 2": "https://protondbplus.blogspot.com/2025/11/tony-hawks-pro-skater-2-2000.html",
"fantastic 4": "https://protondbplus.blogspot.com/2025/11/fantastic-4-2005.html",
"fantastic four": "https://protondbplus.blogspot.com/2025/11/fantastic-4-2005.html",
"juiced": "https://protondbplus.blogspot.com/2025/11/juiced-2005.html",
"need for speed underground 2": "https://protondbplus.blogspot.com/2025/11/need-for-speed-underground-2.html",
"zombs royale": "https://protondbplus.blogspot.com/2025/11/zombs-royale-zombs-royale.html",
"knives out": "https://protondbplus.blogspot.com/2025/11/knives-out.html",
"identivy v": "https://protondbplus.blogspot.com/2025/11/identity-v.html",
"el hero": "https://protondbplus.blogspot.com/2025/11/el-hero.html",
"genshin impact": "https://protondbplus.blogspot.com/2025/11/genshin-impact.html",
"leage of legens": "https://protondbplus.blogspot.com/2025/11/league-of-legends.html",
"lol": "https://protondbplus.blogspot.com/2025/11/league-of-legends.html",
"dragon's dogma online'": "https://protondbplus.blogspot.com/2025/11/protondbplus-dragons-dogma-online.html",
"dragons dogma online'": "https://protondbplus.blogspot.com/2025/11/protondbplus-dragons-dogma-online.html",
"ogbg": "https://protondbplus.blogspot.com/2025/11/protondbplus-ogbattlegrounds-ogbg.html",
"og:bg": "https://protondbplus.blogspot.com/2025/11/protondbplus-ogbattlegrounds-ogbg.html",
"ogbattlegrounds": "https://protondbplus.blogspot.com/2025/11/protondbplus-ogbattlegrounds-ogbg.html",
"bee movie game": "https://protondbplus.blogspot.com/2025/11/protondbplus-bee-movie-game.html",
"bee movie": "https://protondbplus.blogspot.com/2025/11/protondbplus-bee-movie-game.html",
// "tibia": "2025/11/tibia", ou "tibia": "url",
};

chrome.tabs.onUpdated.addListener((tabId, changeInfo, tab) => {
  if (changeInfo.url && changeInfo.url.includes("protondb.com/search?q=")) {
    try {
      const url = new URL(changeInfo.url);
      // .toLowerCase() garante que "SONIC" ou "Sonic" vire "sonic"
      const searchQuery = decodeURIComponent(url.searchParams.get('q')).toLowerCase().trim();

      if (searchQuery && redirects[searchQuery]) {
        const path = redirects[searchQuery];
        let targetUrl;

        // Verifica se você digitou um link completo ou só o caminho
        if (path.startsWith('http')) {
          targetUrl = path;
        } else {
          // Monta a URL no seu blog. Note que o .html é adicionado automaticamente
          targetUrl = `https://protondbplus.blogspot.com/${path}.html`;
        }
        
        chrome.tabs.update(tabId, { url: targetUrl });
      }
    } catch (e) {
      console.error("Erro no redirecionamento:", e);
    }
  }
});
